from harlempy import molset
from harlempy.molset import *

#Load QRDB
def LoadQRDB_OPLS88():
	print("Loading QRDB-OPLS88...")
	QRDB=GetQRDB()
	ref="W. L. Jorgensen and J. Tirado-Rives. The OPLS Force Field for Proteins. Energy Minimizations for Crystals of Cyclic Peptides and Crambin. J. Am. Chem. Soc. 1988, 110, 1657-1666. "
	notes="OPLS88iThinkItInBohr"
	ff=QRDB.NewFF("OPLS88iThinkItInBohr",ref,notes)
	
	at=[]
	#Atom type; Charge, e; Sigma, A; E, kcal/mol
	at.append([ 0, 0.000, 0.000, 0.000 ]) #dummy
	at.append([ 1, 0.500, 3.750, 0.105 ])
	at.append([ 2, -0.500, 2.960, 0.210 ])
	at.append([ 3, -0.570, 3.250, 0.170 ])
	at.append([ 4, 0.370, 0.000, 0.000 ])
	at.append([ 5, 0.200, 3.800, 0.118 ])
	at.append([ 6, 0.200, 3.800, 0.080 ])
	at.append([ 7, 0.000, 3.910, 0.160 ])
	at.append([ 8, 0.000, 3.850, 0.080 ])
	at.append([ 9, 0.000, 3.905, 0.118 ])
	at.append([ 10, 0.000, 3.905, 0.175 ])
	at.append([ 11, 0.000, 3.750, 0.110 ])
	at.append([ 12, -0.850, 3.250, 0.170 ])
	at.append([ 13, 0.425, 0.000, 0.000 ])
	at.append([ 14, 0.285, 3.800, 0.080 ])
	at.append([ 15, 0.285, 3.800, 0.118 ])
	at.append([ 16, -0.100, 3.905, 0.118 ])
	at.append([ 17, 0.700, 3.750, 0.105 ])
	at.append([ 18, -0.800, 2.960, 0.210 ])
	at.append([ 19, 0.310, 3.905, 0.118 ])
	at.append([ 20, -0.300, 3.250, 0.170 ])
	at.append([ 21, 0.330, 0.000, 0.000 ])
	at.append([ 22, 0.265, 3.905, 0.118 ])
	at.append([ 23, -0.700, 3.070, 0.170 ])
	at.append([ 24, 0.435, 0.000, 0.000 ])
	at.append([ 25, 0.265, 3.850, 0.080 ])
	at.append([ 26, 0.265, 3.750, 0.110 ])
	at.append([ 27, 0.310, 3.800, 0.118 ])
	at.append([ 28, 0.100, 3.800, 0.118 ])
	at.append([ 29, 0.310, 3.800, 0.080 ])
	at.append([ 30, 0.100, 3.800, 0.080 ])
	at.append([ 31, 0.180, 3.905, 0.118 ])
	at.append([ 32, -0.450, 3.550, 0.250 ])
	at.append([ 33, 0.270, 0.000, 0.000 ])
	at.append([ 34, 0.235, 3.800, 0.118 ])
	at.append([ 35, -0.470, 3.550, 0.250 ])
	at.append([ 36, 0.235, 3.800, 0.170 ])
	at.append([ 31, 0.300, 3.800, 0.118 ])
	at.append([ 38, -0.300, 3.550, 0.250 ])
	at.append([ 39, 0.200, 3.800, 0.170 ])
	at.append([ 40, -0.570, 3.250, 0.170 ])
	at.append([ 41, 0.420, 0.000, 0.000 ])
	at.append([ 42, -0.490, 3.250, 0.170 ])
	at.append([ 43, 0.410, 3.750, 0.145 ])
	at.append([ 44, 0.100, 3.750, 0.145 ])
	at.append([ 45, 0.130, 3.750, 0.145 ])
	at.append([ 46, -0.540, 3.250, 0.170 ])
	at.append([ 47, 0.460, 0.000, 0.000 ])
	at.append([ 48, 0.500, 3.750, 0.145 ])
	at.append([ 49, 0.330, 3.750, 0.145 ])
	at.append([ 50, -0.055, 3.750, 0.145 ])
	at.append([ 51, -0.800, 3.250, 0.170 ])
	at.append([ 52, 0.460, 0.000, 0.000 ])
	at.append([ 53, 0.640, 2.250, 0.050 ])
	at.append([ 54, -0.700, 3.250, 0.170 ])
	at.append([ 55, 0.440, 0.000, 0.000 ])
	at.append([ 56, 0.310, 3.905, 0.118 ])
	at.append([ 57, 0.070, 3.905, 0.118 ])
	at.append([ 58, 0.550, 3.750, 0.105 ])
	at.append([ 59, -0.450, 2.960, 0.210 ])
	at.append([ 60, 0.250, 3.800, 0.080 ])
	at.append([ 61, 0.250, 3.800, 0.118 ])
	at.append([ 62, -0.400, 3.000, 0.170 ])
	at.append([ 63, 0.250, 3.800, 0.170 ])
	at.append([ 64, 0.200, 3.800, 0.050 ])
	at.append([ 65, 0.000, 3.960, 0.145 ])
	
	mul=pow(2.0,-5.0/6.0)/BOHR_TO_ANG
	for a in at:
		a[2]=a[2]*mul
	
	#for a in at:
	#	print a
	
	#Main Chain
	r=ff.SetRes("GLY", "")
	r.SetAtom("N"   , at[3][1], at[3][2])
	r.SetAtom("H"   , at[4][1], at[4][2])
	r.SetAtom("CA"  , at[5][1], at[5][2])
	r.SetAtom("HA2" , 0.0, 0.0)
	r.SetAtom("HA3" , 0.0, 0.0)
	r.SetAtom("C"   , at[1][1], at[1][2])
	r.SetAtom("O"   , at[2][1], at[2][2])
	r=ff.SetRes("ALA", "")
	r.SetAtom("N"   , at[3][1], at[3][2])
	r.SetAtom("H"   , at[4][1], at[4][2])
	r.SetAtom("CA"  , at[6][1], at[6][2])
	r.SetAtom("HA"  , 0.0, 0.0)
	r.SetAtom("C"   , at[1][1], at[1][2])
	r.SetAtom("O"   , at[2][1], at[2][2])
	r=ff.SetRes("PRO", "")
	r.SetAtom("N"   , at[3][1], at[3][2])
	r.SetAtom("CA"  , at[14][1], at[14][2])
	r.SetAtom("HA"  , 0.0, 0.0)
	r.SetAtom("C"   , at[1][1], at[1][2])
	r.SetAtom("O"   , at[2][1], at[2][2])
	r=ff.SetRes("AIB", "")
	r.SetAtom("N"   , at[3][1], at[3][2])
	r.SetAtom("H"   , at[4][1], at[4][2])
	r.SetAtom("CA"  , at[64][1], at[64][2])
	r.SetAtom("HA"  , 0.0, 0.0)
	r.SetAtom("C"   , at[1][1], at[1][2])
	r.SetAtom("O"   , at[2][1], at[2][2])
	#side chain
	r=ff.SetRes("ALA", "")
	r.SetAtom("CB"  , at[7][1], at[7][2])
	r.SetAtom("HB1" , 0.0, 0.0)
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r=ff.SetRes("AIB", "")
	r.SetAtom("CB"  , at[65][1], at[65][2])
	r.SetAtom("HB1" , 0.0, 0.0)
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r=ff.SetRes("PRO", "")
	r.SetAtom("CD"  , at[15][1], at[15][2])
	r.SetAtom("HD2" , 0.0, 0.0)
	r.SetAtom("HD3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[9][1], at[9][2])
	r.SetAtom("HG2" , 0.0, 0.0)
	r.SetAtom("HG3" , 0.0, 0.0)
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r=ff.CopyRes("ILE", "","ALA","")
	r.SetAtom("CB"  , at[8][1], at[8][2])
	r.SetAtom("HB"  , 0.0, 0.0)
	r.SetAtom("CG2" , at[7][1], at[7][2])
	r.SetAtom("HG21", 0.0, 0.0)
	r.SetAtom("HG22", 0.0, 0.0)
	r.SetAtom("HG23", 0.0, 0.0)
	r.SetAtom("CG1" , at[9][1], at[9][2])
	r.SetAtom("HG12", 0.0, 0.0)
	r.SetAtom("HG13", 0.0, 0.0)
	r.SetAtom("CD1" , at[10][1], at[10][2])
	r.SetAtom("HD11", 0.0, 0.0)
	r.SetAtom("HD12", 0.0, 0.0)
	r.SetAtom("HD13", 0.0, 0.0)
	r=ff.CopyRes("SER", "","ALA","")
	r.SetAtom("CB"  , at[22][1], at[22][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("OG"  , at[23][1], at[23][2])
	r.SetAtom("HG"  , at[24][1], at[24][2])
	r=ff.CopyRes("THR", "","ALA","")
	r.SetAtom("CB"  , at[25][1], at[25][2])
	r.SetAtom("HB"  , 0.0, 0.0)
	r.SetAtom("CG2" , at[7][1], at[7][2])
	r.SetAtom("HG21", 0.0, 0.0)
	r.SetAtom("HG22", 0.0, 0.0)
	r.SetAtom("HG23", 0.0, 0.0)
	r.SetAtom("OG1" , at[23][1], at[23][2])
	r.SetAtom("HG1" , at[24][1], at[24][2])
	r=ff.CopyRes("TYR", "","ALA","")
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[11][1], at[11][2])
	r.SetAtom("CD1" , at[11][1], at[11][2])
	r.SetAtom("HD1" , 0.0, 0.0)
	r.SetAtom("CE1" , at[11][1], at[11][2])
	r.SetAtom("HE1" , 0.0, 0.0)
	r.SetAtom("CZ"  , at[26][1], at[26][2])
	r.SetAtom("OH"  , at[23][1], at[23][2])
	r.SetAtom("HH"  , at[24][1], at[24][2])
	r.SetAtom("CE2" , at[11][1], at[11][2])
	r.SetAtom("HE2" , 0.0, 0.0)
	r.SetAtom("CD2" , at[11][1], at[11][2])
	r.SetAtom("HD2" , 0.0, 0.0)
	r=ff.CopyRes("ASN", "","ALA","")
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[1][1], at[1][2])
	r.SetAtom("OD1" , at[2][1], at[2][2])
	r.SetAtom("ND2" , at[12][1], at[12][2])
	r.SetAtom("HD21", at[13][1], at[13][2])
	r.SetAtom("HD22", at[13][1], at[13][2])
	r=ff.CopyRes("ASP", "","ALA","")
	r.SetAtom("CB"  , at[16][1], at[16][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[17][1], at[17][2])
	r.SetAtom("OD1" , at[18][1], at[18][2])
	r.SetAtom("OD2" , at[18][1], at[18][2])
	r=ff.CopyRes("HIS", "","ALA","")
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[45][1], at[45][2])
	r.SetAtom("ND1" , at[40][1], at[40][2])
	r.SetAtom("HD1" , at[41][1], at[41][2])
	r.SetAtom("CE1" , at[43][1], at[43][2])
	r.SetAtom("HE1" , 0.0, 0.0)
	r.SetAtom("NE2" , at[42][1], at[42][2])
	r.SetAtom("CD2" , at[44][1], at[44][2])
	r.SetAtom("HD2" , 0.0, 0.0)
	#r=ff.SetRes("HIS", "EPSILON")
	#r.SetAtom("CB"  , -0.00740, r_CT)
	#r.SetAtom("HB2" ,  0.03670, r_HC)
	#r.SetAtom("HB3" ,  0.03670, r_HC)
	#r.SetAtom("CG"  ,  0.18680, r_CC)
	#r.SetAtom("ND1" , -0.54320, r_NB)
	#r.SetAtom("CE1" ,  0.16350, r_CR)
	#r.SetAtom("HE1" ,  0.14350, r_H5)
	#r.SetAtom("NE2" , -0.27950, r_NA)
	#r.SetAtom("HE2" ,  0.33390, r_H)
	#r.SetAtom("CD2" , -0.22070, r_CW)
	#r.SetAtom("HD2" ,  0.18620, r_H4)
	r=ff.CopyRes("HIS", "PROT","ALA","")
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[49][1], at[49][2])
	r.SetAtom("ND1" , at[46][1], at[46][2])
	r.SetAtom("HD1" , at[47][1], at[47][2])
	r.SetAtom("CE1" , at[48][1], at[48][2])
	r.SetAtom("HE1" , 0.0, 0.0)
	r.SetAtom("NE2" , at[46][1], at[46][2])
	r.SetAtom("HE2" , at[47][1], at[47][2])
	r.SetAtom("CD2" , at[49][1], at[49][2])
	r.SetAtom("HD2" , 0.0, 0.0)
	r=ff.CopyRes("TRP", "","ALA","")
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[50][1], at[50][2])
	r.SetAtom("CD1" , at[45][1], at[45][2])
	r.SetAtom("HD1" , 0.0, 0.0)
	r.SetAtom("NE1" , at[40][1], at[40][2])
	r.SetAtom("HE1" , at[41][1], at[41][2])
	r.SetAtom("CE2" , at[45][1], at[45][2])
	r.SetAtom("CZ2" , at[11][1], at[11][2])
	r.SetAtom("HZ2" , 0.0, 0.0)
	r.SetAtom("CH2" , at[11][1], at[11][2])
	r.SetAtom("HH2" , 0.0, 0.0)
	r.SetAtom("CZ3" , at[11][1], at[11][2])
	r.SetAtom("HZ3" , 0.0, 0.0)
	r.SetAtom("CE3" , at[11][1], at[11][2])
	r.SetAtom("HE3" , 0.0, 0.0)
	r.SetAtom("CD2" , at[50][1], at[50][2])
	r=ff.CopyRes("LYS", "","ALA","")
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[9][1], at[9][2])
	r.SetAtom("HG2" , 0.0, 0.0)
	r.SetAtom("HG3" , 0.0, 0.0)
	r.SetAtom("CD"  , at[9][1], at[9][2])
	r.SetAtom("HD2" , 0.0, 0.0)
	r.SetAtom("HD3" , 0.0, 0.0)
	r.SetAtom("CE"  , at[19][1], at[19][2])
	r.SetAtom("HE2" , 0.0, 0.0)
	r.SetAtom("HE3" , 0.0, 0.0)
	r.SetAtom("NZ"  , at[20][1], at[20][2])
	r.SetAtom("HZ1" , at[21][1], at[21][2])
	r.SetAtom("HZ2" , at[21][1], at[21][2])
	r.SetAtom("HZ3" , at[21][1], at[21][2])
	r=ff.CopyRes("VAL", "","ALA","")
	r.SetAtom("CB"  , at[8][1], at[8][2])
	r.SetAtom("HB"  , 0.0, 0.0)
	r.SetAtom("CG1" , at[7][1], at[7][2])
	r.SetAtom("HG11", 0.0, 0.0)
	r.SetAtom("HG12", 0.0, 0.0)
	r.SetAtom("HG13", 0.0, 0.0)
	r.SetAtom("CG2" , at[7][1], at[7][2])
	r.SetAtom("HG21", 0.0, 0.0)
	r.SetAtom("HG22", 0.0, 0.0)
	r.SetAtom("HG23", 0.0, 0.0)
	r=ff.CopyRes("LEU", "","ALA","")
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[8][1], at[8][2])
	r.SetAtom("HG"  , 0.0, 0.0)
	r.SetAtom("CD1" , at[7][1], at[7][2])
	r.SetAtom("HD11", 0.0, 0.0)
	r.SetAtom("HD12", 0.0, 0.0)
	r.SetAtom("HD13", 0.0, 0.0)
	r.SetAtom("CD2" , at[7][1], at[7][2])
	r.SetAtom("HD21", 0.0, 0.0)
	r.SetAtom("HD22", 0.0, 0.0)
	r.SetAtom("HD23", 0.0, 0.0)
	r=ff.CopyRes("PHE", "","ALA","")
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[11][1], at[11][2])
	r.SetAtom("CD1" , at[11][1], at[11][2])
	r.SetAtom("HD1" , 0.0, 0.0)
	r.SetAtom("CE1" , at[11][1], at[11][2])
	r.SetAtom("HE1" , 0.0, 0.0)
	r.SetAtom("CZ"  , at[11][1], at[11][2])
	r.SetAtom("HZ"  , 0.0, 0.0)
	r.SetAtom("CE2" , at[11][1], at[11][2])
	r.SetAtom("HE2" , 0.0, 0.0)
	r.SetAtom("CD2" , at[11][1], at[11][2])
	r.SetAtom("HD2" , 0.0, 0.0)
	r=ff.CopyRes("CYS", "","ALA","")
	r.SetAtom("CB"  , at[31][1], at[31][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("SG"  , at[32][1], at[32][2])
	r.SetAtom("HG"  , at[33][1], at[33][2])
	r=ff.CopyRes("CYM", "","ALA","")
	r.SetAtom("CB"  , at[37][1], at[37][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("SG"  , at[38][1], at[38][2])
	r=ff.CopyRes("MET", "","ALA","")
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[34][1], at[34][2])
	r.SetAtom("HG2" , 0.0, 0.0)
	r.SetAtom("HG3" , 0.0, 0.0)
	r.SetAtom("SD"  , at[35][1], at[35][2])
	r.SetAtom("CE"  , at[36][1], at[36][2])
	r.SetAtom("HE1" , 0.0, 0.0)
	r.SetAtom("HE2" , 0.0, 0.0)
	r.SetAtom("HE3" , 0.0, 0.0)
	r=ff.CopyRes("GLN", "","ALA","")
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[9][1], at[9][2])
	r.SetAtom("HG2" , 0.0, 0.0)
	r.SetAtom("HG3" , 0.0, 0.0)
	r.SetAtom("CD"  , at[1][1], at[1][2])
	r.SetAtom("OE1" , at[2][1], at[2][2])
	r.SetAtom("NE2" , at[12][1], at[12][2])
	r.SetAtom("HE21", at[13][1], at[13][2])
	r.SetAtom("HE22", at[13][1], at[13][2])
	r=ff.CopyRes("GLU", "","ALA","")
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[16][1], at[16][2])
	r.SetAtom("HG2" , 0.0, 0.0)
	r.SetAtom("HG3" , 0.0, 0.0)
	r.SetAtom("CD"  , at[17][1], at[17][2])
	r.SetAtom("OE1" , at[18][1], at[18][2])
	r.SetAtom("OE2" , at[18][1], at[18][2])
	r=ff.CopyRes("ARG", "","ALA","")
	r.SetAtom("CB"  , at[9][1], at[9][2])
	r.SetAtom("HB2" , 0.0, 0.0)
	r.SetAtom("HB3" , 0.0, 0.0)
	r.SetAtom("CG"  , at[57][1], at[57][2])
	r.SetAtom("HG2" , 0.0, 0.0)
	r.SetAtom("HG3" , 0.0, 0.0)
	r.SetAtom("CD"  , at[56][1], at[56][2])
	r.SetAtom("HD2" , 0.0, 0.0)
	r.SetAtom("HD3" , 0.0, 0.0)
	r.SetAtom("NE"  , at[54][1], at[54][2])
	r.SetAtom("HE"  , at[55][1], at[55][2])
	r.SetAtom("CZ"  , at[53][1], at[53][2])
	r.SetAtom("NH1" , at[51][1], at[51][2])
	r.SetAtom("HH11", at[52][1], at[52][2])
	r.SetAtom("HH12", at[52][1], at[52][2])
	r.SetAtom("NH2" , at[51][1], at[51][2])
	r.SetAtom("HH21", at[52][1], at[52][2])
	r.SetAtom("HH22", at[52][1], at[52][2])
	
	#NTerm
	r=ff.SetRes("GLY", "NT")
	r.SetAtom("N"   , at[20][1], at[20][2])
	r.SetAtom("H1"  , at[21][1], at[21][2])
	r.SetAtom("H2"  , at[21][1], at[21][2])
	r.SetAtom("H3"  , at[21][1], at[21][2])
	r.SetAtom("CA"  , at[27][1], at[27][2])
	r.SetAtom("HA2" , 0.0, 0.0)
	r.SetAtom("HA3" , 0.0, 0.0)
	r.SetAtom("C"   , at[1][1], at[1][2])
	r.SetAtom("O"   , at[2][1], at[2][2])
	
	rl=[]
	rl.append(["ALA", ""])
	#rl.append(["PRO", ""])
	rl.append(["AIB", ""])
	rl.append(["ILE", ""])
	rl.append(["SER", ""])
	rl.append(["THR", ""])
	rl.append(["TYR", ""])
	rl.append(["ASN", ""])
	rl.append(["ASP", ""])
	rl.append(["HIS", ""])
	rl.append(["HIS", "PROT"])
	rl.append(["TRP", ""])
	rl.append(["LYS", ""])
	rl.append(["VAL", ""])
	rl.append(["LEU", ""])
	rl.append(["PHE", ""])
	rl.append(["CYS", ""])
	rl.append(["CYM", ""])
	rl.append(["MET", ""])
	rl.append(["GLN", ""])
	rl.append(["GLU", ""])
	rl.append(["ARG", ""])
	for rr in rl:
		name=rr[0]
		mod="NT"
		if rr[1]!="":
			mod=rr[1]+"_NT"
		r=ff.CopyRes(name, mod,rr[0],rr[1])
		r.DelAtom("H")
		r.SetAtom("N"   , at[20][1], at[20][2])
		r.SetAtom("H1"  , at[21][1], at[21][2])
		r.SetAtom("H2"  , at[21][1], at[21][2])
		r.SetAtom("H3"  , at[21][1], at[21][2])
		r.SetAtom("CA"  , at[29][1], at[29][2])
		r.SetAtom("HA"  , 0.0, 0.0)
		r.SetAtom("C"   , at[1][1], at[1][2])
		r.SetAtom("O"   , at[2][1], at[2][2])
		
	#CTERM
	r=ff.NewRes("GLY", "CT")
	r.SetAtom("N"   , at[3][1], at[3][2])
	r.SetAtom("H"   , at[4][1], at[4][2])
	r.SetAtom("CA"  , at[28][1], at[28][2])
	r.SetAtom("HA2"  , 0.0, 0.0)
	r.SetAtom("HA3"  , 0.0, 0.0)
	r.SetAtom("C"   , at[17][1], at[17][2])
	r.SetAtom("O"   , at[18][1], at[18][2])
	r.SetAtom("OXT" , at[18][1], at[18][2])
	for rr in rl:
		name=rr[0]
		mod="CT"
		if rr[1]!="":
			mod=rr[1]+"_CT"
		r=ff.CopyRes(name, mod,rr[0],rr[1])
		r.SetAtom("N"   , at[3][1], at[3][2])
		r.SetAtom("H"   , at[4][1], at[4][2])
		r.SetAtom("CA"  , at[30][1], at[30][2])
		r.SetAtom("HA"  , 0.0, 0.0)
		r.SetAtom("C"   , at[17][1], at[17][2])
		r.SetAtom("O"   , at[18][1], at[18][2])
		r.SetAtom("OXT" , at[18][1], at[18][2])
	#ff.PrintEntries()
	#ff.PrintSumDbl0()
	#print

LoadQRDB_OPLS88()

